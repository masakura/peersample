var app=app||{};!function(){"use strict";navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia}(),app.view=function(){"use strict";return{waiting:function(){$("#call-box").show(),$("#catch-box").hide(),$("#call").show(),$("#calling").hide(),$(".disconnect").hide()},calling:function(){$("#call-box").show(),$("#catch-box").hide(),$("#call").hide(),$("#calling").show(),$(".disconnect").hide()},catching:function(a){$("#call-box").hide(),$("#catch-box").show(),$("#catch").show(),$(".disconnect").hide(),$("#catch-other-peerid").val(a)},talking:function(){$("#call-box").hide(),$("#catch-box").show(),$("#catch").hide(),$(".disconnect").show()}}}(),$(document).ready(function(){"use strict";var a=function(a){$("<p>").text(a).appendTo("#messages")},b=function(a){$("#other-video").prop("src",URL.createObjectURL(a)),app.view.talking()},c=function(){$("#other-video").prop("src",""),app.view.waiting()},d=function(){var d,e,f;return{start:function(){navigator.getUserMedia({audio:!0,video:!0},function(a){$("#video").prop("src",URL.createObjectURL(a)),d=a},function(b){a(b)}),e=new Peer({key:"vvx00u5ssce1xlxr"}),e.on("error",function(b){a(JSON.stringfy(b))}),e.on("open",function(b){a(b)}),e.on("call",function(a){f=a,$("#catch-other-peerid").val(f.peer),$("#call-box").hide(),$("#catch-box").show()}.bind(this)),app.view.waiting()},call:function(a){f=e.call(a,d),f.on("stream",b),f.on("close",c),app.view.calling()},answer:function(){f.answer(d),f.on("stream",b),f.on("close",c)},disconnect:function(){f.close()}}}();d.start(),$(document).on("click","#call",function(){d.call($("#other-peerid").val())}).on("click","#catch",function(){d.answer()}).on("click",".disconnect",function(){d.disconnect()})});